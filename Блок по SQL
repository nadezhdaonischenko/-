Блок 3: SQL
Задание 1: Абитуриенты
Есть таблица examination с двумя полями: id (id абитуриента), scores (кол-во набранных баллов дополнительного вступительного испытания от 0 до 100).
Требуется реализовать запрос, который создаёт колонку с позицией абитуриента в общем рейтинге.

SELECT 
       id as id_абитуриента,
       scores as количество_баллов,
       DENSE_RANK() OVER(ORDER BY scores DESC) as ранг
FROM 
       examination
ORDER BY 
       rank;    # необязательная строка, но улучшает таблицу

Задание 2: FULL JOIN
Представьте две таблицы: первая содержит 30 строк, а вторая — 20 строк. Мы выполняем операцию FULL JOIN между ними.
Какой диапазон возможного количества строк может быть в результирующей таблице, если учесть, что ключи для соединения могут быть как полностью совпадающими, так и абсолютно уникальными?
Ответ: минимально 20 (при условии полного совпадения всех колонок таблиц, идентичные строки) и максимально 50 строк

Задание 3: Покупки
create table account
(
    id integer, -- ID счета
    client_id integer, -- ID клиента
    open_dt date, -- дата открытия счета
    close_dt date -- дата закрытия счета
)

create table transaction
(
    id integer,  -- ID транзакции
    account_id integer,  -- ID счета
    transaction_date date,  -- дата транзакции
    amount numeric(10,2), -- сумма транзакции
    type varchar(3) -- тип транзакции 
)
Вывести ID клиентов, которые за последний месяц по всем своим счетам совершили покупок меньше, чем на 5000 рублей.
Без использования подзапросов и оконных функций.

SELECT 
       client_id as ID_клиента
FROM
       account a
JOIN 
       transaction t ON (a.id=t.account_id)
WHERE 
       t.transaction_date >= CURRENT_DATE - INTERVAL '30 DAYS' AND 
       t.type = 'buy'
GROUP BY 
       a.client_id
HAVING 
       SUM(t.amount numeric)>5000
